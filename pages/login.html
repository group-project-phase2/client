<link rel="stylesheet" type="text/css" href="css/login-style.css">

<!-- Google Platform Library  -->
<script src="https://apis.google.com/js/platform.js"></script>
<meta name="google-signin-client_id" content="323874734298-vrlavakg3iqb6ig2qbp22c7ijisk1pd9.apps.googleusercontent.com">

<div class="hb-container">
	<div class="hb-wrap">
		<div class="hb-form-title" style="background-image: url(images/login-bg.jpg);">
			<span class="hb-title">
				Sign In
			</span>
		</div>

		<div class="container p-5 m-2">
			<form>
				<div class="form-group row p-3">
					<label for="staticEmail" class="col-sm-2 col-form-label">Email</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" value="email@example.com">
					</div>
				</div>

				<div class="form-group row p-3">
					<label for="inputPassword" class="col-sm-2 col-form-label">Password</label>
					<div class="col-sm-10">
						<input type="password" class="form-control" id="inputPassword" placeholder="Password">
					</div>
				</div>

				<div class="col text-center">
					<button type="button" class="btn btn-primary" style="width: 40%;"
						onclick="Main.callPage('search.html')" id="login-btn">Login</button>
						<br>
				</div>

				<div class="text-center p-3">
					<small>Or, login with: </small>
				</div>
				<div class="g-signin2" data-onsuccess="onSignIn"></div>
				<button onclick="signOut()">signout</button>
			</form>
		</div>

	</div>
	
</div>

<script>
	$('#login-btn').click( function() {
		Swal.fire(
			'Good job!',
			'You clicked the button!',
			'success'
		)
	} )
	const server_url = "http://localhost:3000"

	function signOut() {
		
		var auth2 = gapi.auth2.getAuthInstance();
		auth2.signOut().then(function () {
			localStorage.removeItem("token")
			console.log('User signed out.');
		});
		Main.callPage('login.html');
	}
	function onSignIn(googleUser) {
		let idToken = googleUser.getAuthResponse().id_token
		// console.log(idToken)
		axios({
			method: "POST",
			url: `${server_url}/users/Gsignin`,
			data: {
				idToken
			}
		})
		.then(response => {
			// console.log(response.data)
			let token = response.data.token
			localStorage.setItem('token', token)
		})
		.catch(err => {
			console.log("error")
		})
	}
</script>